(()=>{"use strict";if(void 0===lpGlobalSettings)throw new Error("lpGlobalSettings is undefined");const e={apiCourses:lpGlobalSettings.lp_rest_url+"lp/v1/courses/archive-course"};(()=>{if(void 0===lpGlobalSettings)return void console.log("lpGlobalSettings is undefined");let t=window.location.href;t.includes("?")&&(t=t.split("?")[0]);const o=window.location.search,s=new URLSearchParams(o);let r,n,l,a,c,i={},u=!1,p=1;const d={};for(const[e,t]of s.entries())d[e]=t;if(window.localStorage.setItem("lp_filter_courses",JSON.stringify(d)),!lpGlobalSettings.lpArchiveLoadAjax)return void console.log("Option load courses ajax is disabled");const h=(e,t)=>{const o=new URL(e);return Object.keys(t).forEach((e=>{o.searchParams.set(e,t[e])})),o};window.lpArchiveRequestCourse=(o,s)=>{if(u)return;u=!0;const d=h(t,o);window.history.pushState("","",d),r&&(r.style.display="block"),i=o,window.localStorage.setItem("lp_filter_courses",JSON.stringify(o));const g=h(e.apiCourses,o),f=e.apiCourses+g.search;let y={method:"GET"};0!==lpGlobalSettings.user_id&&(y={...y,headers:{"X-WP-Nonce":lpGlobalSettings.nonce}}),fetch(f,y).then((e=>e.json())).then((e=>{if(a=e.data.content||"",c=e.data.pagination||"",!p){l.querySelectorAll(":not(.lp-archive-course-skeleton)").forEach((e=>{e.closest(".lp-archive-course-skeleton")||e.remove()})),r&&(r.insertAdjacentHTML("beforebegin",a),r.style.display="none");const e=c,t=document.querySelector(".learn-press-pagination");if(t&&t.remove(),void 0!==e){const t=(new DOMParser).parseFromString(e,"text/html").querySelector(".learn-press-pagination");t&&(l.after(t),v())}}wp.hooks.doAction("lp-js-get-courses",e),"function"==typeof s&&s(e)})).catch((e=>{l.innerHTML+=`<div class="lp-ajax-message error" style="display:block">${e.message||"Error: Query lp/v1/courses/archive-course"}</div>`})).finally((()=>{u=!1;const e=document.querySelector("form.search-courses button");if(e&&e.classList.remove("loading"),p)p=0;else{const e={behavior:"smooth"};n.scrollIntoView(e)}}))},lpGlobalSettings.lpArchiveNoLoadAjaxFirst?p=0:lpArchiveRequestCourse({...lpGlobalSettings.lpArchiveSkeleton,...d});const v=()=>{const e=document.querySelectorAll(".lp-archive-courses .learn-press-pagination .page-numbers");e.length>0&&e.forEach((t=>t.addEventListener("click",(o=>{if(o.preventDefault(),o.stopPropagation(),n&&(n.scrollIntoView({behavior:"smooth"}),o.currentTarget.getAttribute("href"))){const s=[...e].filter((e=>e.classList.contains("current"))),r=o.currentTarget.textContent||t.classList.contains("next")&&parseInt(s[0].textContent)+1||t.classList.contains("prev")&&parseInt(s[0].textContent)-1;i.paged=r,lpArchiveRequestCourse(i)}}))))},g=()=>{(()=>{if(!lpGlobalSettings.lpArchiveNoLoadAjaxFirst){r&&(r.insertAdjacentHTML("beforebegin",a),r.style.display="none");const e=c,t=document.querySelector(".learn-press-pagination");if(t&&t.remove(),void 0!==e){const t=(new DOMParser).parseFromString(e,"text/html").querySelector(".learn-press-pagination");t&&l.after(t)}}v(),document.querySelectorAll("form.search-courses").forEach((e=>{const t=e.querySelector('input[name="c_search"]'),o=e.querySelector('[type="submit"]');let s;t.addEventListener("keyup",(e=>{e.preventDefault();const t=e.target.value.trim();(!t||t&&t.length>2)&&(void 0!==s&&clearTimeout(s),s=setTimeout((function(){o.classList.add("loading"),i.c_search=t,i.paged=1,lpArchiveRequestCourse(i)}),800))})),e.addEventListener("submit",(t=>{t.preventDefault();const o=e.querySelector('input[name="c_search"]');o&&o.dispatchEvent(new Event("keyup"))}))}))})(),(()=>{const e=document.querySelectorAll('.lp-archive-courses input[name="lp-switch-layout-btn"]');e.length>0&&e.forEach((e=>e.addEventListener("change",(e=>{e.preventDefault();const t=e.target.value;if(t){const e=document.querySelector(".lp-archive-courses .learn-press-courses[data-layout]");e&&(e.dataset.layout=t),LP.Cookies.set("courses-layout",t)}}))))})(),(()=>{const e=LP.Cookies.get("courses-layout"),t=document.querySelectorAll('.lp-courses-bar .switch-layout [name="lp-switch-layout-btn"]');t.length>0&&[...t].map((t=>t.value===e&&(t.checked=!0)))})()},f=setInterval((function(){r=document.querySelector(".lp-archive-course-skeleton"),n=document.querySelector(".lp-archive-courses"),n&&(l=n.querySelector(".learn-press-courses"));let e=!1;l&&r&&((lpGlobalSettings.lpArchiveNoLoadAjaxFirst||a)&&(e=!0),e&&(g(),clearInterval(f)))}),1)})()})();